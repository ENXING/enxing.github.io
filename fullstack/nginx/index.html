<!DOCTYPE html>
<html lang="en-us"><head>
  
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nginx | Enxing Xiong</title>
  
  
  
    
      





<meta name="title" content="Nginx | Enxing Xiong" />
<meta name="description" content="GYM Backup: mongoexport -d exercise -c workouts -f _id,exercise.name,exercise._id,repeat,weight &ndash;type=csv -o workout.csv mongoimport -d exercise -c workouts &ndash;type=csv &ndash;headerline &ndash;file=workout.csv Restore mongodump mongorestore &ndash;db exercise ./dump/exercise nodemon screen -ls screen -S myname screen -S myname -X quit screen -r myname ctrl&#43;a d: detach Mongodb db.workouts.update({}, {$set:{&ldquo;deleted&rdquo;:false}}, false, true) db.workouts.deleteMany({deleted:true}); nginx: setting server { listen 80 default_server; server_name _; return 301 https://$host$request_uri; } server { listen 443 ssl; ssl_certificate /root/.acme.sh/workoutreport.ga/fullchain.cer; ssl_certificate_key /root/."> 


<link rel="canonical" href="https://enxing.github.io/fullstack/nginx/" />


  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:description" content="" /> 
  <meta name="twitter:title" content="Nginx | Enxing Xiong" />
  <meta name="twitter:url" content="https://enxing.github.io/fullstack/nginx/" />
  
  
   



  
  <meta property="og:title" content="Nginx | Enxing Xiong" />
  <meta property="og:description" content="" /> 
  <meta property="og:site_name" content="Enxing Xiong" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://enxing.github.io/fullstack/nginx/" />
  
   



<meta property="article:published_time" content="2022-11-20 03:03:14 -0500 EST" />


  
  
  <script type="application/ld+json">
      { 
          "@context": "http://schema.org", 
          "@type": "WebSite", 
          "url": "https://enxing.github.io/", 
          "name": "Nginx",
          "author": {
            "@type": "Person",
            "name":  null 
          },
          
          "description":  null ,
          
        }
      </script>
  


    
    <meta name="generator" content="Hugo 0.106.0">
  
  
  
  
  
  <link rel="stylesheet" href="/assets/css/main.min.ee63c6a21edc35a42ca386c15b748eaead69d91b94b47372c296696ac5e89e7e.css" integrity="sha256-7mPGoh7cNaQso4bBW3SOrq1p2RuUtHNywpZpasXonn4=" crossorigin="anonymous">
  
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  
  
  
  
  
  <meta name="theme-color" content="#fff6f8">
  
  <meta name="msapplication-navbutton-color" content="#fff6f8">
  
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  
</head>
<body><header>
  <nav class="navbar navbar-expand-lg navbar-light fixed-top flex-column">
    <div class="container-fluid">
      
      <a class="navbar-brand rounded px-3" href="https://enxing.github.io/"><span class="text-nav"><span class="brand">&nbsp;&nbsp;&nbsp;Enxing Xiong</span></span></a>
      
      
    </div>
    
  </nav>
</header>
<div id="content">
<div class="container-fluid bg-clr1 text-nav text-center pb-3 pt-4 position-relative shadow-sm">
  <div style="height:3.5rem;"></div>
  <h1>Nginx</h1>
  
</div>
<div class="container bg-nav py-3">
  <h1 id="gym">GYM</h1>
<h2 id="backup">Backup:</h2>
<ul>
<li>mongoexport -d exercise -c workouts -f _id,exercise.name,exercise._id,repeat,weight &ndash;type=csv -o workout.csv</li>
<li>mongoimport -d exercise -c workouts &ndash;type=csv &ndash;headerline &ndash;file=workout.csv</li>
</ul>
<h2 id="restore">Restore</h2>
<ul>
<li>mongodump</li>
<li>mongorestore &ndash;db exercise ./dump/exercise</li>
</ul>
<h2 id="nodemon">nodemon</h2>
<ul>
<li>screen -ls</li>
<li>screen -S myname</li>
<li>screen -S myname -X quit</li>
<li>screen -r myname</li>
<li>ctrl+a d: detach</li>
</ul>
<h1 id="mongodb">Mongodb</h1>
<ul>
<li>db.workouts.update({}, {$set:{&ldquo;deleted&rdquo;:false}}, false, true)</li>
<li>db.workouts.deleteMany({deleted:true});</li>
</ul>
<h1 id="nginx">nginx:</h1>
<h2 id="setting">setting</h2>
<pre tabindex="0"><code>server {
listen 80 default_server;
server_name _;
return 301 https://$host$request_uri;
}
server {
listen              443 ssl;
ssl_certificate  /root/.acme.sh/workoutreport.ga/fullchain.cer;
ssl_certificate_key /root/.acme.sh/workoutreport.ga/workoutreport.ga.key;
ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
root /var/www/html;
index index.html index.htm index.nginx-debian.html;
server_name _;
location /api {
proxy_pass http://localhost:10201;
}
location / {
proxy_pass http://localhost:10203;
index index.html;
}
}
</code></pre><ul>
<li>blockPort.sh $(grep -e &ldquo;:[0-9]{1,5}&rdquo; /etc/nginx/sites-enabled/default |grep &quot; *[^#]proxy_pass&quot;|sed -r &rsquo;s/[^0-9]//g&rsquo; |tr &lsquo;\n&rsquo; &rsquo; &lsquo;)</li>
<li>watch tail /var/log/nginx/access.log</li>
</ul>
<h2 id="troubleshooting">troubleshooting</h2>
<ul>
<li></li>
</ul>
<pre tabindex="0"><code>Simple location prefix matching works for this without using a rewrite rule as long as you specify a URI in the proxy_pass directive:

location /foo {
  proxy_pass http://localhost:3200/;
}
Notice the additional / at the end of the proxy_pass directive. NGINX will strip the matched prefix /foo and pass the remainder to the backend server at the URI /. Therefore, http://myserver:80/foo/bar will post to the backend at http://localhost:3200/bar.
</code></pre><ul>
<li>/etc/nginx/sites-available</li>
<li>apache
<ul>
<li>/var/log/apache2/access.log</li>
<li>watch tail cat /var/log/apache2/access.log</li>
</ul>
</li>
</ul>
<h2 id="firewall-block-port-from-other-source-except-localhost">firewall block port from other source except localhost</h2>
<ul>
<li></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>iptables -A INPUT -p tcp -s localhost --dport <span style="color:#ae81ff">10201</span> -j ACCEPT
</span></span><span style="display:flex;"><span>iptables -A INPUT -p tcp --dport <span style="color:#ae81ff">10201</span>  -j DROP
</span></span></code></pre></div>
</div>

    </div><footer class="text-center p-2 text-muted footer">
  

  

  <div class="py-2 copyright">
    <small>Copyright &#169; 2022 Enxing Xiong <b>&#183;</b> Powered by <a class="font-weight-bold text-reset text-decoration-none" href="https://gohugo.io">Hugo</a> <b>&#183;</b> Theme <a class="font-weight-bold text-reset text-decoration-none" href="https://github.com/Softorage/HugoTheme-VibrantShadows">Vibrant Shadows</a> by <span class="softorage"><a class="font-weight-bold text-reset" href="https://softorage.com">Softorage</a></span></small>
  </div>
</footer>

    
    
    
    <script src="/assets/js/main.min.77838d21b7cc69ac1156e27d3703139dadd6a286e57dabc1f3b2c6d294a81e92.js" integrity="sha256-d4ONIbfMaawRVuJ9NwMTna3WooblfavB87LG0pSoHpI=" crossorigin="anonymous"></script>
    <script src="/assets/js/custom.min.21d1b65b48adbed41de7ac42ee68e7f9e464985356770f7e0b877b89044eb469.js" integrity="sha256-IdG2W0itvtQd56xC7mjn&#43;eRkmFNWdw9&#43;C4d7iQROtGk=" crossorigin="anonymous"></script>
    
    <link href="https://fonts.googleapis.com/css?family=Roboto|Lato&display=swap" rel="stylesheet">
    
    
    
  </body>
</html>
